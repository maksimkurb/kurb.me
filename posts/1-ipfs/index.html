<!doctype html><html lang=ru><head><title>Введение в IPFS :: @maksimkurb</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="В данном материале я расскажу, что такое IPFS и с чем его едят"><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://cubly.ru/posts/1-ipfs/><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-44581121-8","auto"),ga("send","pageview"))</script><link rel=stylesheet href=../../assets/style.css><link rel=stylesheet href=../../assets/cubly.css><link rel=apple-touch-icon href=../../img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=../../img/favicon/cubly.png><meta name=twitter:card content="summary"><meta property="og:locale" content="ru"><meta property="og:type" content="article"><meta property="og:title" content="Введение в IPFS"><meta property="og:description" content="В данном материале я расскажу, что такое IPFS и с чем его едят"><meta property="og:url" content="https://cubly.ru/posts/1-ipfs/"><meta property="og:site_name" content="@maksimkurb"><meta property="og:image" content="/post-resources/1-ipfs/ipfs-logo.jpg"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2021-11-17 00:00:00 +0000 UTC"></head><body class=cubly><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=../../><div class=logo>@maksimkurb</div></a></div><div class=menu-trigger>меню</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=../../posts>Публикации</a></li><li><a href=../../cv>Резюме</a></li><li class=menu__external><a href=https://github.com/maksimkurb/ target=_blank>GitHub</a></li><li class=menu__external><a href=https://t.me/maksimkurb target=_blank>Telegram</a></li><li class=menu__external><a href=https://www.linkedin.com/in/maxim-kurbatov/ target=_blank>LinkedIn</a></li><div class=spacer></div><ul class=language-selector><ul class=language-selector-current><li>ru ▾</li></ul><ul class="language-selector__more hidden"><li><a href=../../>ru</a></li><li><a href=../../en/>en</a></li></ul></ul></ul><ul class="menu__inner menu__inner--mobile"><li><a href=../../posts>Публикации</a></li><li><a href=../../cv>Резюме</a></li><li class=menu__external><a href=https://github.com/maksimkurb/ target=_blank>GitHub</a></li><li class=menu__external><a href=https://t.me/maksimkurb target=_blank>Telegram</a></li><li class=menu__external><a href=https://www.linkedin.com/in/maxim-kurbatov/ target=_blank>LinkedIn</a></li><hr><li><a href=../../>ru</a></li><li><a href=../../en/>en</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=../../posts/1-ipfs/>Введение в IPFS</a></h1><div class=post-meta><span class=post-date>2021-11-17</span>
<span class=post-author>:: Maxim Kurbatov</span>
<span class=post-reading-time>:: 10 мин. на чтение</span><div class=post-languages></div></div><img src=../../post-resources/1-ipfs/ipfs-logo.jpg class=post-cover alt="Введение в IPFS" title="Cover Image"><div class=post-content><div><p>Выясним что же такое IPFS.</p><blockquote><p><strong>IPFS (InterPlanetary File System)</strong> &mdash; это распределённая система для хранения и доступа к файлам, вебсайтам, приложениям и данным.</p></blockquote><p>IPFS &mdash; это пиринговая сеть хранения данных. Контент доступен через одноранговые узлы, расположенные в любой точке мира, которые могут передавать информацию, хранить ее или делать и то, и другое. Принцип работы IPFS схож с работой BitTorrent-клиентов, IPFS тоже использует <em>распределённые хеш-таблицы</em> (<strong>DHT</strong>) и способен за секунды найти участников сети, которые могут поделиться запрашиваемыми файлами. Чтобы понять, какие это даёт преимущества, стоит понять разницу в том, как мы сёрфим привычный нам интернет и как это отличается от подхода, предлагаемого IPFS.</p><p>Когда мы пользуемся браузером, для доступа к контенту мы используем <strong>URL</strong> (<strong>Uniform Resource Locator</strong>), который говорит, где мы можем найти тот или иной контент.
Пример такого адреса &mdash; <code>https://mysite.com/my_perfect_book.pdf</code></p><p>Что мы можем понять из этого адреса? Файл называется <code>my_perfect_book.pdf</code>, находится на сайте <code>mysite.com</code>, IP-адрес которого мы можем узнать с помощью <strong>DNS</strong>. Нам неизвестно ничего о содержимом контента, пока мы не загрузим его, более того, содержимое может меняться со временем, так <a href=https://int0x33.medium.com/solarwinds-what-probably-most-likely-happened-ec4e588ce5da>мы можем скачать совсем не то, что ожидали</a>. Также есть риск того, что материалы будут подвергнуты цензуре (возможно, <a href=https://www.linux.org.ru/forum/talks/14315937>даже по ошибке</a>), либо сайт просто прекратит своё существование.</p><p>В IPFS, в отличие от классического веба, используются адреса следующего вида: <code>QmXoypizjW3WknFiJnKLwHCnL72vedxjQkDDP1mXWo6uco</code>, называемые <strong>Content Identifier</strong> (сокращённо <strong>CID</strong>). В отличие от традиционных <strong>URL</strong>, которые указывают на то, где файл расположен, адреса <strong>IPFS</strong> создаются на основе содержимого контента (если быть точнее, вычисляется <a href=https://ru.wikipedia.org/wiki/%D0%9A%D1%80%D0%B8%D0%BF%D1%82%D0%BE%D0%B3%D1%80%D0%B0%D1%84%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B0%D1%8F_%D1%85%D0%B5%D1%88-%D1%84%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D1%8F>криптографический хеш</a>). Это даёт нам два преимущества:</p><ol><li><p>Мы всегда можем проверить, что скачанные нами данные не были подменены кем-либо, просто посчитав для него хеш-функцию. Если хоть один байт файла отличается, хеши просто не совпадут, и IPFS отбросит такой файл.</p></li><li><p>Так как адрес указывает не &ldquo;откуда&rdquo;, а &ldquo;какие&rdquo; получить данные, их становится гораздо сложнее подвергнуть цензуре. Файлы могут находиться сразу в нескольких хранилищах, в кеше пользователей IPFS, поэтому даже если полностью заблокировать весь внешний интернет, данные можно будет получить, если они остались в хранилище хотя бы у одного достижимого пира.</p></li></ol><h2 id=как-устроен-ipfs>Как устроен IPFS?<a href=#как-устроен-ipfs class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Для понимания IPFS необходимо разобрать 3 фундаментальных принципа:</p><ol><li><p>Уникальная идентификация ресурса с помощью контентной адресации</p></li><li><p>Связывание контента с помощью направленных ациклических графиков (DAGs)</p></li><li><p>Обнаружение контента с помощью распределенных хэш-таблиц (DHTs)</p></li></ol><h3 id=контентная-адресация-в-ipfs>Контентная адресация в IPFS<a href=#контентная-адресация-в-ipfs class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Данный пункт мы уже частично разобрали выше, для каждого образа данных создаётся <strong>Content Identifier</strong> (<strong>CID</strong>) &mdash; хеш-сумма, которая уникально адресует эти данные. На самом деле, помимо хеш-суммы, CID содержит версию (сейчас их существует две, CID версии 0 начинаются на <code>Qm</code>, CID версии 1 устроены несколько сложнее и содержат в себе <a href=https://github.com/multiformats/multibase#multibase-table>префикс способа кодирования</a> CID и <a href="https://ipfs.io/ipfs/QmXec1jjwzxWJoNbxQF5KffL8q6hFXm9QwUGaa3wKGk6dT/#title=Multicodecs&src=https://raw.githubusercontent.com/multiformats/multicodec/master/table.csv">формат содержимого</a>, чтобы программы знали, как интерпретировать контент). На официальном сайте есть <a href=https://cid.ipfs.io/#bafybeigdyrzt5sfp7udm7hu76uh7y26nf3efuylqabf3oclgtqy55fbzdi>удобная страница</a>, которая показывает, как интерпретировать CID.</p><h3 id=что-такое-merkle-dag-и-как-это-используется-в-ipfs>Что такое Merkle DAG и как это используется в IPFS?<a href=#что-такое-merkle-dag-и-как-это-используется-в-ipfs class=hanchor arialabel=Anchor>&#8983;</a></h3><figure class=left><img src=../../post-resources/1-ipfs/dag.png style=background:#f2f6ff><figcaption class=center>Бинарное хеш-дерево</figcaption></figure><p><a href=https://ru.wikipedia.org/wiki/%D0%94%D0%B5%D1%80%D0%B5%D0%B2%D0%BE_%D1%85%D0%B5%D1%88%D0%B5%D0%B9>Дерево Меркла</a> (или Дерево Хешей) &mdash; это полное двоичное дерево, листья которого содержат хеши блоков данных, а внутренние вершины содержат хеши от сложения значений в их дочерних вершинах. В IPFS вместо хешей используются Content Identifier.</p><p>Такая структура позволяет IPFS связывать сложные структуры, например, целую папку файлов или git-репозиторий. Большие файлы в IPFS разбиваются на чанки (размер которых зависит от типа контента), соответственно, при загрузке большого файла в IPFS также будет построено дерево хешей, имеющее свой CID и указывающего на CID каждого чанка. Существует <a href=https://explore.ipld.io/#/explore/QmSnuWmxptJZdLJpKRarxBMS2Ju2oANVrgbr2xWbie9b2D>специальный инструмент</a>, наглядно показывающий такие деревья.</p><p>Если вдруг мы решим изменить часть файла и опубликовать новую версию в IPFS, хеш листьев, отвечающих за изменённые блоки данных, изменится, вследствие чего изменятся хеши их родительских элементов, вплоть до корневого. Однако хеш тех листьев, контент блоков которых не изменился, останется прежним, соответственно, новый и старый файл, хоть и будут иметь разные CID, но будут ссылаться на одни и те же CID совпадающих блоков данных. Таким образом, достигается дедупликация контента.</p><h3 id=обнаружение-контента-с-помощью-dht>Обнаружение контента с помощью DHT<a href=#обнаружение-контента-с-помощью-dht class=hanchor arialabel=Anchor>&#8983;</a></h3><p><strong>Хеш-таблица</strong> &mdash; это обычная таблица с двумя полями: ключ и значение.
<strong>Распределённая хеш-таблица</strong> &mdash; это таблица, которая разделена между всеми пирами в распределенной сети. Чтобы найти контент, необходимо спросить о нём среди своих пиров.</p><p>После того, как IPFS узнаёт, где находится контент (а если быть точнее, у каких пиров хранятся блоки данных, из которых состоит загружаемый контент), IPFS использует DHT ещё раз, чтобы узнать, где эти пиры находятся на данный момент (процедура маршрутизации).</p><p>Теперь мы знаем, у каких пиров есть нужный нам контент и как с этими пирами связаться. Затем, IPFS связывается с этими пирами, отправляет им список желаний (CID блоков, которые мы хотим получить), а пиры отправляют эти блоки. После получения блоков данных, IPFS генерирует CID на основе полученных данных, чтобы сверить его с CID, который мы запросили. Таким образом, можно проверить, что данные не были никем подменены.</p><h2 id=а-где-хранятся-данные>А где хранятся данные?<a href=#а-где-хранятся-данные class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Публикуемые в IPFS данные хранятся на нодах &mdash; участниках сети. Если вы создавали свои торрент-раздачи, вы знаете, что изначально файлы есть только у вас, вы публикуете их и раздаёте другим участникам. Если вы не успеете никому отдать свою копию файлов и выключите свой компьютер, никто не сможет скачать ваши данные, поэтому нужно дождаться, пока хотя бы несколько человек их скачают и начнут раздавать, прежде чем самому уходить с раздачи.</p><figure class=left><img src=../../post-resources/1-ipfs/ipfs-desktop.png><figcaption class=center>Список закреплённых файлов на локальной ноде</figcaption></figure><p>В IPFS всё происходит похожим образом. Как только вы публикуете какой-либо контент на локальной ноде, он &ldquo;закрепляется&rdquo; (<strong>pinning</strong>), IPFS будет хранить его вечно на вашем устройстве, пока вы не открепите его (<strong>unpin</strong>). Когда кто-то запросит контент, который есть у вас, он автоматически сохранит его копию в свой локальный кеш. Однако, следует иметь в виду, что данный кеш не перманентный, следовательно, со временем тот пир перестанет раздавать эту информацию, если к ней никто долго не обращался. При этом никто не запрещает другому пиру также &ldquo;закрепить&rdquo; скачанные от вас файлы, тогда он продолжит раздавать их вместе с вами.</p><blockquote><p>Пользователи IPFS закрепляют себе ту информацию, которую считают ценной для себя, поэтому информация, которая никем не закреплена (а значит, никому не представляет ценности) со временем удаляется для экономии места.</p></blockquote><p>Понятно, что держать опубликованную информацию на своем личном устройстве и постоянно раздавать её &mdash; не всегда удобно, для решения этой проблемы на помощь приходят <a href=https://docs.ipfs.io/concepts/persistence/#pinning-services>Pinning Services</a>, по сути, это можно считать облачным хранилищем, куда можно загрузить свои данные, чтобы они были всегда доступны в IPFS.</p><h2 id=интеграция-с-всемирной-паутиной>Интеграция с всемирной паутиной<a href=#интеграция-с-всемирной-паутиной class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Для интеграции с существующим вебом существует две технологии, которые применяются совместно: <strong>IPFS Gateway</strong> и <strong>DNSLink</strong></p><h3 id=ipfs-gateway>IPFS Gateway<a href=#ipfs-gateway class=hanchor arialabel=Anchor>&#8983;</a></h3><p><a href=https://docs.ipfs.io/concepts/ipfs-gateway>Шлюз IPFS</a> &mdash; это сервер, который позволяет получить доступ к файлам в сети IPFS из браузеров, пока не поддерживающих доступ к IPFS напрямую. Шлюз можно поднять у себя локально, либо воспользоваться публичным, например <a href=https://ipfs.io>https://ipfs.io</a>. Следует отметить, что при использовании шлюза, вы не сможете проверять CID скачанных файлов на клиентском устройстве, поэтому вы должны доверять шлюзу, либо не пользоваться им вовсе.</p><h3 id=dnslink>DNSLink<a href=#dnslink class=hanchor arialabel=Anchor>&#8983;</a></h3><p><a href=https://docs.ipfs.io/concepts/dnslink/>DNSLink</a> использует TXT-записи DNS для того, чтобы закрепить CID за определённым доменом. Например, мы можем узнать, что домен <a href=https://ipfs.io/>ipfs.io</a> указывает на CID <code>Qmf6DcRku4QUBjkToCSj3dMkhipUgg1NURYSMUFNsj1jsF</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ dig +noall +answer TXT <span style=color:#ae81ff>\_</span>dnslink.ipfs.io
</span></span><span style=display:flex><span><span style=color:#ae81ff>\_</span>dnslink.ipfs.io. <span style=color:#ae81ff>30</span> IN TXT <span style=color:#e6db74>&#34;dnslink=/ipns/website.ipfs.io&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ dig +noall +answer TXT <span style=color:#ae81ff>\_</span>dnslink.website.ipfs.io
</span></span><span style=display:flex><span><span style=color:#ae81ff>\_</span>dnslink.website.ipfs.io. <span style=color:#ae81ff>30</span> IN TXT <span style=color:#e6db74>&#34;dnslink=/ipfs/Qmf6DcRku4QUBjkToCSj3dMkhipUgg1NURYSMUFNsj1jsF&#34;</span>
</span></span></code></pre></div><p>Как видно из примера выше, TXT-запись <code>_dnslink.ipfs.io</code> указывала на адрес <code>/ipns/website.ipfs.io</code>, а <code>website.ipfs.io</code>, в свою очередь, указывает на конкретный IPFS CID.</p><p>Тут стоит ещё упомянуть <a href=https://docs.ipfs.io/concepts/ipns/>IPNS (InterPlanetary Name System)</a>. IPNS позволяет вам создавать длинные адреса вида <code>k5...</code>, которые ссылаются на конкретный CID и могут быть обновлены вами. Таким образом при загрузке новой версии файла у вас не будет необходимости рассылать всем новый CID, пользователи сразу узнают его, обращаясь к данным по IPNS. <strong>DNSLink</strong> является альтернативой IPNS, используя доменные имена, вместо длинных хешей. DNSLink работает быстрее и легко запоминается, однако нужно понимать, что DNS-сервера могут быть подвергнуты блокировкам, либо их ответ может быть подменён, если вы не используете <a href=https://www.cloudflare.com/ru-ru/learning/dns/dns-over-tls/>DoH или DoT</a>.</p><h2 id=как-пользоваться>Как пользоваться<a href=#как-пользоваться class=hanchor arialabel=Anchor>&#8983;</a></h2><p>Можно поставить себе консольную утилиту <a href=https://docs.ipfs.io/how-to/command-line-quick-start/>ipfs-cli</a> или <a href=https://docs.ipfs.io/install/ipfs-desktop/>десктопный клиент</a>, который включает в себя IPFS-ноду и файловый менеджер, а также <a href=https://docs.ipfs.io/install/ipfs-companion/#install>расширение для браузера</a>, которое позволит открывать IPFS-ссылки в своём браузере, используя локальную ноду.</p><p>В этой статье в качестве примера мы создадим одностраничный сайт-резюме, опубликуем его в IPFS, используя один из pinning-сервисов, и настроим DNS, чтобы при открытии нашего сайта из обычного браузера пользователи могли его увидеть.</p><h3 id=создание-одностраничного-сайта-резюме>Создание одностраничного сайта-резюме<a href=#создание-одностраничного-сайта-резюме class=hanchor arialabel=Anchor>&#8983;</a></h3><figure class=left><img src=../../post-resources/1-ipfs/hugo-logo-wide.svg></figure><p>Нам нужно подготовить статичную версию сайта, простой набор страничек. На этом этапе долго останавливаться не будем, <a href=https://gohugo.io/getting-started/quick-start/>на данной странице</a> можно найти пошаговую инструкцию по созданию такого сайта с помощью генератора <a href=https://gohugo.io/>Hugo</a> (<a href=https://thecode.media/hugo/>а вот тут можно найти инструкцию на русском</a>).</p><div class=collapsable-code><input id=942173568 type=checkbox>
<label for=942173568><span class=collapsable-code__language>bash</span>
<span class=collapsable-code__title>Создаём заготовку статичного сайта</span>
<span class=collapsable-code__toggle data-label-expand=△ data-label-collapse=▽></span></label><pre class=language-bash><code>

# Устанавливаем Hugo

snap install hugo

# Создаем основу вебсайта

hugo new site my-website
cd my-website

# Устанавливаем тему

# Список существующих тем: &lt;https://themes.gohugo.io/&gt;

git init
git submodule add &lt;https://github.com/gurusabarish/hugo-profile.git&gt; themes/hugo-profile

# Включаем тему

rm config.toml
cp ./themes/hugo-profile/website/v3.yaml ./config.yaml
sed -i &#39;s/\\.\\/\\.\\./hugo-profile/g&#39; ./config.yaml

# Редактируем созданную конфигурацию под себя

vim ./config.yaml

# Запускаем сервер для просмотра получившегося сайта

hugo serve
</code></pre></div><p>Переходим по ссылке <a href=http://localhost:1313>http://localhost:1313</a> и видим получившийся сайт:</p><figure class=left><img src=../../post-resources/1-ipfs/hugo-bootstrap.png><figcaption class=center>Одностраничный сайт на типовом шаблоне hugo-profile от Guru Sabarish</figcaption></figure><p>Теперь мы можем ввести команду hugo , и наш сайт скомпилируется в папку public. Содержимое этой папки мы и будем публиковать в IPFS.</p><h3 id=публикация-файлов-в-ipfs>Публикация файлов в IPFS<a href=#публикация-файлов-в-ipfs class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Чтобы нам не приходилось держать свой компьютер постоянно включённым, воспользуемся одним из <a href=https://docs.ipfs.io/concepts/persistence/#pinning-services>Pinning сервисов</a>. Я выбрал <a href=https://www.pinata.cloud/>Pinata</a>, он предоставляет 1ГБ бесплатного хранилища и не требует привязки банковской карты.</p><p>После регистрации и загрузки папки public на сайт, мы получаем CID, по которому мы можем посмотреть наше содержимое:</p><figure class=left><img src=../../post-resources/1-ipfs/pinata.png><figcaption class=center>Жёлтым выделен Content Identifier загруженной папки</figcaption></figure><p>Нажав на значок глаза левее, мы можем просмотреть наш сайт в браузере (как можно заметить, я выбрал другой шаблон для своего сайта):</p><figure class=left><img src=../../post-resources/1-ipfs/this-site.png><figcaption class=center>Этот сайт, загруженный в IPFS и открытый через IPFS Gateway</figcaption></figure><p>Также мы можем открыть приложение IPFS Desktop и посмотреть содержимое папки с сайтом, введя CID в поле в верхней части интерфейса. Папка может загрузиться не сразу, следует подождать, пока IPFS найдет пиров, у которых она есть.</p><figure class=left><img src=../../post-resources/1-ipfs/site-on-ipfs.png><figcaption class=center>Содержимое нашей папки с сайтом, загруженной в сеть IPFS</figcaption></figure><p>Запомним наш CID, он пригодится нам позднее, когда мы будем настраивать свой домен: QmZkSWaUY1dTeCNokmBdV9rS2SgRBGvTzbA2Xk49EPc6FE.</p><h3 id=настройка-dns-часть-1>Настройка DNS, часть 1<a href=#настройка-dns-часть-1 class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Последним этапом будет ассоциация нашего доменного имени с Content Identifier (помните, мы говорили про <a href=http://docs.ipfs.io.ipns.localhost:8080/concepts/dnslink/>DNSLink</a>?). Будем считать, что у вас уже есть собственное доменное имя и доступ к настройке его DNS-записей.</p><p>В моём распоряжении есть доменное имя <a href=https://cubly.ru>cubly.ru</a>, DNS-записи которого управляются через Cloudflare. Чтобы сайт был доступен по нашему доменному имени пользователям IPFS, нам необходимо создать TXT-запись с именем <code>_dnslink.&lt;доменное_имя></code> и значением <code>dnslink=/ipfs/&lt;ваш_CID></code>.</p><figure class=left><img src=../../post-resources/1-ipfs/cloudflare-txt-entry.png><figcaption class=center>TXT-запись, указывающая на CID моей папки</figcaption></figure><p>После этого наш сайт стал доступен для пользователей IPFS помимо адреса /ipfs/QmZk.. через более лаконичный и запоминающийся адрес /ipns/cubly.ru (<a href=https://ipfs.io/ipns/cubly.ru/>посмотреть через IPFS Gateway</a>).</p><p>Если мы установим плагин IPFS Companion и попробуем открыть сайт <a href=https://cubly.ru>cubly.ru</a> в браузере, плагин автоматически определит, что сайт доступен в IPFS (найдя созданную нами TXT-запись) и переадресует на наш локальный Gateway: <a href=http://cubly.ru.ipns.localhost:8080>http://cubly.ru.ipns.localhost:8080</a>. Наш локальный IPFS Gateway убедится, что все загруженные браузером файлы подлинные, подсчитав их хеш-суммы.</p><figure class=left><img src=../../post-resources/1-ipfs/ipfs-plugin-status.png><figcaption class=center>TXT-запись, указывающая на CID моей папки</figcaption></figure><p>Как видно на скриншоте, в плагине есть опция &ldquo;Import to Files on My Node&rdquo;. Мы можем нажать на неё, чтобы импортировать содержимое сайта на нашу IPFS-ноду и раздавать содержимое сайта уже со своего компьютера, чтобы сайт открывался быстрее у пользователей, которые находятся в вашем городе, пока IPFS Desktop запущен. Если вы закроете его, то сайт всё равно останется доступен, ведь он есть на Pinata и у других нод, которые успели закешировать его, просто вашим соседям придётся немного подождать, пока их IPFS нода найдёт другие пиры.</p><h3 id=настройка-dns-часть-2>Настройка DNS, часть 2<a href=#настройка-dns-часть-2 class=hanchor arialabel=Anchor>&#8983;</a></h3><p>Мы настроили DNSLink запись, и сайт стал доступен по удобному имени для пользователей IPFS, но что делать с пользователями, которые ещё не пользуются Web 3.0?</p><p>Всё до банальности просто: мы настроим CNAME-запись, которая перенаправит всех обычных пользователей на публичный IPFS Gateway. Так как я пользуюсь Cloudflare, будет логично воспользоваться их собственным IPFS Gateway: cloudflare-ipfs.com. Почитать о нём можно в <a href=https://blog.cloudflare.com/continuing-to-improve-our-ipfs-gateway/>блоге Cloudflare</a>.</p><p>Нам же достаточно просто добавить CNAME-запись на наш домен и проверить, что сайт открывается с любого устройства:</p><figure class=left><img src=../../post-resources/1-ipfs/cloudflare-cname-entry.png><figcaption class=center>Добавление CNAME-записи на домен cubly.ru</figcaption></figure><p>Имейте в виду, что по стандарту, CNAME-запись невозможно применить на корневой домен, Cloudflare автоматически подставляет IP-адрес cloudflare-ipfs.com в нашу запись. Если ваш DNS-провайдер не умеет делать это автоматически, можно создать A-запись, указывающую на IP cloudflare-ipfs.com:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ nslookup cloudflare-ipfs.com
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Non-authoritative answer:
</span></span><span style=display:flex><span>Name: cloudflare-ipfs.com
</span></span><span style=display:flex><span>Address: 104.17.64.14
</span></span><span style=display:flex><span>Name: cloudflare-ipfs.com
</span></span><span style=display:flex><span>Address: 104.17.96.13
</span></span><span style=display:flex><span>Name: cloudflare-ipfs.com
</span></span><span style=display:flex><span>Address: 2606:4700::6811:400e
</span></span><span style=display:flex><span>Name: cloudflare-ipfs.com
</span></span><span style=display:flex><span>Address: 2606:4700::6811:600d
</span></span></code></pre></div><figure class=left><img src=../../post-resources/1-ipfs/cloudflare-a-entry.png><figcaption class=center>Создаём A-запись, указывающую на IP Cloudflare IPFS Gateway</figcaption></figure><p>Теперь сайт должен стать доступным для всех пользователей, в том числе для тех, кто не пользуется IPFS. Как видно из скриншота ниже, IPFS Companion выключен, а сайт продолжает открываться.</p><figure class=left><img src=../../post-resources/1-ipfs/ipfs-plugin-off.png><figcaption class=center>Размещённый в IPFS сайт доступен для всех пользователей</figcaption></figure><h2 id=итог>Итог<a href=#итог class=hanchor arialabel=Anchor>&#8983;</a></h2><p>В результате мы с вами познакомились с IPFS и принципом её работы, а также опубликовали свой сайт в общей сети, обеспечив доступ к нему пользователям IPFS и Web. Просматривая сайт, пользователи IPFS будут сохранять его ресурсы в своём кеше, увеличивая его доступность, скорость его загрузки и делая его более распределённым.</p><p>У IPFS масса применений, вот несколько из них:</p><ul><li><p>хранение ресурсов, привязанных к <a href=https://ru.wikipedia.org/wiki/%D0%9D%D0%B5%D0%B2%D0%B7%D0%B0%D0%B8%D0%BC%D0%BE%D0%B7%D0%B0%D0%BC%D0%B5%D0%BD%D1%8F%D0%B5%D0%BC%D1%8B%D0%B9_%D1%82%D0%BE%D0%BA%D0%B5%D0%BD>NFT токенам</a> или к транзакциям блокчейна;</p></li><li><p><a href=https://qri.io/>совместное хранение больших датасетов</a>;</p></li><li><p>децентрализованный <a href=https://d.tube/>видеохостинг</a> и <a href=https://decentraland.org/>виртуальная реальност</a>ь;</p></li><li><p>CDN;</p></li><li><p><a href=https://killcord.io/>Deadman Switch</a>;</p></li><li><p><a href=https://github.com/orbitdb/orbit-db>распределённая базы данных</a>;</p></li><li><p><a href=https://awesome.ipfs.io/>и многое другое</a>.</p></li></ul><p>Присоединяйтесь к становлению Распределённого Веба ✌️</p></div></div></div></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>Maxim Kurbatov</span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=../../assets/main.js></script>
<script src=../../assets/prism.js></script>
<script src=../../assets/languageSelector.js></script></div></body></html>